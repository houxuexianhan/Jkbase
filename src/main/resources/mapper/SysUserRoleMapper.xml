<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jack.jkbase.mapper.SysUserRoleMapper" >
  <resultMap id="BaseResultMap" type="com.jack.jkbase.entity.SysUserRole" >
    <id column="R_UserID" property="rUserid" jdbcType="INTEGER" />
    <id column="R_RoleID" property="rRoleid" jdbcType="INTEGER" />
  </resultMap>
  <resultMap id="ViewUserRoles" type="com.jack.jkbase.entity.ViewUserRole" extends="BaseResultMap">
    <association property="user" javaType="com.jack.jkbase.entity.SysUser" resultMap="com.jack.jkbase.mapper.SysUserMapper.BaseResultMap"/>
  </resultMap>
   <!-- 根据角色ID查找用户列表 -->
  <select id="selectByRoleId" parameterType="java.lang.Integer" resultMap="ViewUserRoles">
   select * from View_sys_roleUser where R_RoleID = #{param1}
  </select>
 <!-- 根据用户ID查找角色列表 -->
  <select id="selectByUser" parameterType="java.lang.Integer" resultMap="BaseResultMap">
   select * from sys_UserRole where R_UserID = #{param1}
  </select>
  <!-- 某个角色下批量插入用户 -->
  <insert id="insertbatchForRole">
  	 insert into sys_UserRole (R_UserID, R_RoleID)
   	 values 
   	  <foreach collection="users" item="userId" index="index" separator=",">
   	 	(#{userId}, #{roleId})
   	 </foreach>
  </insert>
  <!-- 某个用户下批量插入角色 -->
  <insert id="insertbatchForUser">
  	 delete sys_UserRole where R_UserID=#{userId}
  	 insert into sys_UserRole (R_UserID, R_RoleID)
   	 values 
   	  <foreach collection="roles" item="roleId" index="index" separator=",">
   	 	(#{userId}, #{roleId})
   	 </foreach>
  </insert>
  <!-- 删除某用户下的所有角色 -->
  <delete id="deleteByUser" parameterType="java.lang.Integer">
  	delete from sys_UserRole where R_UserID = #{param1}
  </delete>
 <!-- 删除某角色 下的所有用户-->
  <delete id="deleteByRole" parameterType="java.lang.Integer">
  	delete from sys_UserRole where R_RoleID = #{param1}
  </delete>
  
  <!-- 自动生成  -->
    <delete id="deleteByPrimaryKey" parameterType="com.jack.jkbase.entity.SysUserRole" >
    delete from sys_UserRole
    where R_UserID = #{rUserid,jdbcType=INTEGER}
      and R_RoleID = #{rRoleid,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.jack.jkbase.entity.SysUserRole" >
    insert into sys_UserRole (R_UserID, R_RoleID)
    values (#{rUserid,jdbcType=INTEGER}, #{rRoleid,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.jack.jkbase.entity.SysUserRole" >
    insert into sys_UserRole
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="rUserid != null" >
        R_UserID,
      </if>
      <if test="rRoleid != null" >
        R_RoleID,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="rUserid != null" >
        #{rUserid,jdbcType=INTEGER},
      </if>
      <if test="rRoleid != null" >
        #{rRoleid,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
</mapper>